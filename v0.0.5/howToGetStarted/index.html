<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>How to get started · GigaSOM.jl</title><link rel="canonical" href="https://lcsb-biocore.github.io/GigaSOM.jl/stable/howToGetStarted/index.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/gigasomlogotransp.ico" rel="icon" type="image/x-icon"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.svg" alt="GigaSOM.jl logo"/></a><h1>GigaSOM.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../background/">Background</a></li><li class="current"><a class="toctext" href>How to get started</a><ul class="internal"><li><a class="toctext" href="#Cytometry-Data-1">Cytometry Data</a></li><li><a class="toctext" href="#Input-and-output-1">Input and output</a></li><li><a class="toctext" href="#Creating-a-Self-Organizing-MAP-(SOM)-1">Creating a Self Organizing MAP (SOM)</a></li></ul></li><li><a class="toctext" href="../functions/">Functions</a></li><li><a class="toctext" href="../howToContribute/">How to contribute</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>How to get started</a></li></ul><a class="edit-page" href="https://github.com/LCSB-BioCore/GigaSOM.jl/blob/master/docs/src/howToGetStarted.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>How to get started</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="How-to-get-started-1" href="#How-to-get-started-1">How to get started</a></h1><p>For the installation of Julia or GigaSOM.jl please refer to the installation instructions.</p><h2><a class="nav-anchor" id="Cytometry-Data-1" href="#Cytometry-Data-1">Cytometry Data</a></h2><p>In this example we will use a subset of the Cytometry data from Bodenmiller et al. (Bodenmiller et al., 2012). This data-set contains samples from peripheral blood mononuclear cells (PBMCs) in unstimulated and stimulated conditions for 8 healthy donors.</p><p>10 cell surface markers (lineage markers) are used to identify different cell populations:     - PBMC8<em>panel.xlsx (with Antigen name and columns for lineage markers and functional markers)     - PBMC8</em>metadata.xlsx (file names, sample id, condition and patient id)</p><p>Before running this minimum working example, make sure to use the package:</p><pre><code class="language-julia">using GigaSOM</code></pre><h2><a class="nav-anchor" id="Input-and-output-1" href="#Input-and-output-1">Input and output</a></h2><p>The example data can be downloaded from <a href="http://imlspenticton.uzh.ch/robinson_lab/cytofWorkflow/">imlspenticton.uzh.ch/robinson_lab/cytofWorkflow/</a></p><p>You can fetch the files directly from within Julia:</p><pre><code class="language-julia"># fetch the required data for testing and download the zip archive and unzip it
dataFiles = [&quot;PBMC8_metadata.xlsx&quot;, &quot;PBMC8_panel.xlsx&quot;, &quot;PBMC8_fcs_files.zip&quot;]
for f in dataFiles
    if !isfile(f)
        download(&quot;http://imlspenticton.uzh.ch/robinson_lab/cytofWorkflow/&quot;*f, f)
        if occursin(&quot;.zip&quot;, f)
            run(`unzip PBMC8_fcs_files.zip`)
        end
    end
end</code></pre><p>Read meta-data and panel as a <code>DataFrame</code>, and make sure that the column names match the CyTOF FCS file names:</p><pre><code class="language-julia"># Read  files as DataFrames
md = GigaSOM.DataFrame(GigaSOM.XLSX.readtable(&quot;PBMC8_metadata.xlsx&quot;, &quot;Sheet1&quot;)...)
panel = GigaSOM.DataFrame(GigaSOM.XLSX.readtable(&quot;PBMC8_panel.xlsx&quot;, &quot;Sheet1&quot;)...)
panel[:Isotope] = map(string, panel[:Isotope])
panel[:Metal] = map(string, panel[:Metal])
panel[:Antigen] = map(string, panel[:Antigen])
panel.Metal[1]=&quot;&quot;
GigaSOM.insertcols!(panel,4,:fcs_colname =&gt; map((x,y,z)-&gt;x.*&quot;(&quot;.*y.*z.*&quot;)&quot;.*&quot;Dd&quot;,panel[:Antigen],panel[:Metal],panel[:Isotope]))
print(panel.fcs_colname)</code></pre><p>Extract the lineage and functional markers with <code>getMarkers()</code> function:</p><pre><code class="language-julia">lineageMarkers, functionalMarkers = getMarkers(panel)</code></pre><p>Read FCS files <code>readFlowset()</code>:</p><pre><code class="language-julia">fcsRaw = readFlowset(md.file_name)</code></pre><p><code>readFlowset()</code> is a wrapper function around <a href="https://github.com/tlnagy/FCSFiles.jl">FCSFiles.jl</a>. Please note the current limitations of this package (i.e., the <a href="https://github.com/tlnagy/FCSFiles.jl/blob/master/src/parse.jl#L20">limit for large files</a>).</p><p>Clean names to remove problematic characters in the column names:</p><pre><code class="language-julia">cleanNames!(fcsRaw)</code></pre><p>Finally, create a <code>daFrame</code> that contains the expression data as well as panel and meta-data. It automatically applies a <code>asinh</code> tranformation with a cofactor of 5.</p><pre><code class="language-julia">daf = createDaFrame(fcsRaw, md, panel)</code></pre><h2><a class="nav-anchor" id="Creating-a-Self-Organizing-MAP-(SOM)-1" href="#Creating-a-Self-Organizing-MAP-(SOM)-1">Creating a Self Organizing MAP (SOM)</a></h2><p>The main advantage of <code>GigaSOM.jl</code> is the capability of parallel processing. In order to activate this dependency, please activate the GigaSOM environment:</p><pre><code class="language-julia">import Pkg; Pkg.activate(&quot;GigaSOM&quot;)</code></pre><p>Alternatively, on the REPL, you can also activate the <code>GigaSOM</code> environment by typing <code>]</code>:</p><pre><code class="language-julia">v(1.1) pkg&gt; activate GigaSOM</code></pre><p>Without the explicit declaration of multiple workers, <code>GigaSOM</code> will train the SOM grid on a single core. Therefore, we will add some workers and make sure that <code>GigaSOM</code> is accessible to all the workers:</p><pre><code class="language-julia">using Distributed
addprocs(2) # the number of workers can be higher than 2
@everywhere using GigaSOM</code></pre><p>We will use only the lineage markers (cell surface) for the training of the SOM map and extract the expression data:</p><pre><code class="language-julia">cc = map(Symbol, lineageMarkers)
dfSom = daf.fcstable[:,cc]</code></pre><p>Initialize the SOM grid by size and expression values:</p><pre><code class="language-julia">som2 = initGigaSOM(dfSom, 10, 10)</code></pre><p>Train the SOM grid with the initialized SOM object and define the number of training rounds (also referred to as <em>epochs</em>).</p><pre><code class="language-julia"> som2 = trainGigaSOM(som2, dfSom, epochs = 10)</code></pre><p>Finally, calculate the winner neurons from the trained SOM object:</p><pre><code class="language-julia">winners = mapToGigaSOM(som2, dfSom)</code></pre><footer><hr/><a class="previous" href="../background/"><span class="direction">Previous</span><span class="title">Background</span></a><a class="next" href="../functions/"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
